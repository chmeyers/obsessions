give_next_shield_tech_option_effect = {
	if = {
		limit = { NOT = { has_technology = tech_shields_2 }  }
		add_research_option = tech_shields_2
		add_tech_progress = { tech = tech_shields_2 progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_shields_3 } } 
		add_research_option = tech_shields_3
		add_tech_progress = { tech = tech_shields_3 progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_shields_4 } } 
		add_research_option = tech_shields_4
		add_tech_progress = { tech = tech_shields_4 progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_shields_5 } } 
		add_research_option = tech_shields_5
		add_tech_progress = { tech = tech_shields_5 progress = 0.5 }
	}
	else = {
		add_research_option = tech_repeatable_improved_shield_output
		add_tech_progress = { tech = tech_repeatable_improved_shield_output progress = 0.75 }
	}
}

give_next_gene_tech_effect = {
	if = {
		limit = { NOT = { has_technology = tech_genome_mapping } } 
		add_research_option = tech_genome_mapping
		add_tech_progress = { tech = tech_genome_mapping progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_vitality_boosters } } 
		add_research_option = tech_vitality_boosters
		add_tech_progress = { tech = tech_vitality_boosters progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_epigenetic_triggers } } 
		add_research_option = tech_epigenetic_triggers
		add_tech_progress = { tech = tech_epigenetic_triggers progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_cloning } } 
		add_research_option = tech_cloning
		add_tech_progress = { tech = tech_cloning progress = 0.5 }
	}
	else = {
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier3researchreward
			min = @tier3researchmin
			max = @tier3researchmax
		}
	}
}

give_next_alloys_tech_effect = {
	if = {
		limit = { NOT = { has_technology = tech_alloys_1 } } 
		add_research_option = tech_alloys_1 
		add_tech_progress = { tech = tech_alloys_1 progress = 0.75 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_alloys_2 } } 
		add_research_option = tech_alloys_2
		add_tech_progress = { tech = tech_alloys_2 progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_advanced_metallurgy_1 } } 
		add_research_option = tech_advanced_metallurgy_1
		add_tech_progress = { tech = tech_advanced_metallurgy_1 progress = 0.5 }
	}
	else_if = {
		limit = { NOT = { has_technology = tech_advanced_metallurgy_2 } } 
		add_research_option = tech_advanced_metallurgy_2
		add_tech_progress = { tech = tech_advanced_metallurgy_2 progress = 0.5 }
	}
	else = {
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier3researchreward
			min = @tier3researchmin
			max = @tier3researchmax
		}
	}
}

create_obsessed_pirate_king = {
	event_target:obsessions_planet_target = {
		save_event_target_as = pirate_home
		create_country = {
			name = "NAME_Obsession"
			type = pirate
			species = event_target:obsessed_scientist_species
			name_list = "PRT1"
			flag = {
				background = {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors ={
					"black"
					"black"
					"null"
					"null"
				}
			}
			effect = {
				save_event_target_as = pirate_band
			}
		}
		event_target:pirate_band = {
			set_name = random
			randomize_flag_symbol = "pirate"
			assign_leader = event_target:obsessed_scientist_breakdown
			every_country = {
				establish_communications_no_message = prev
			}
			create_fleet = {
				name = "NAME_Obsession"
				effect = {
					set_owner = event_target:pirate_band
					create_privateer_ships_10 = yes
					assign_leader = event_target:obsessed_scientist_breakdown
					set_location = event_target:obsessions_planet_target
					set_fleet_stance = aggressive
					set_aggro_range_measure_from = self
					set_aggro_range = 800
				}
			}
		}
	}
}

create_obsessed_country = {
	if = {
		limit = {
			NOT = {
				any_country = {
					is_country_type = adversary
					has_country_flag = obsession_country
				}
			}
		}
		create_country = {
			name = "NAME_Obsession"
			species = event_target:obsessed_scientist_species
			type = adversary
			ethos = random
			origin = origin_default
			auto_delete = no
			
			effect = {
				set_country_flag = obsession_country
				set_leader = event_target:obsessed_scientist_breakdown
				establish_contact = {
					who = event_target:obsession_source_country location = event_target:obsessions_planet_target
				}
				establish_communications_no_message = event_target:obsession_source_country
				save_global_event_target_as = obsession_created_country
				add_resource = { influence = 200 }
				add_resource = { energy = 15000 }
				add_resource = { food = 15000 }
				add_resource = { minerals = 15000 }
				add_resource = { alloys = 5000 }
				add_resource = { consumer_goods = 5000 }
				add_resource = { unity = 15000 }
			}
		}
	}
}

obsessed_take_system = {
	solar_system = {
		if = {
			limit = { exists = starbase }
			starbase = {
				set_owner = event_target:obsession_created_country
			}
		}
		else = {
			create_starbase = {
				size = starbase_outpost
				owner = event_target:obsession_created_country
			}
		}
	}
}

obsessed_take_planet = {
	set_owner = event_target:obsession_created_country
	if = {
		limit = {
			is_colony = no
		}
		create_colony = {
			owner = event_target:obsession_created_country
			species = event_target:obsessed_scientist_species
		}
	}
	while = {
		count = 5
		create_pop = {
			species = event_target:obsessed_scientist_species
		}
	}
}

create_obsessed_fleet = {
	event_target:obsessions_planet_target = {
		create_fleet = {
			name = "NAME_Obsession"
			effect = {
				set_owner = event_target:obsession_created_country
				create_privateer_ships_9 = yes
				set_location = event_target:obsessions_planet_target
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = self
				set_aggro_range = 800
			}
		}
	}
}